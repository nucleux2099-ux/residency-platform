(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{3948:function(e,t,i){Promise.resolve().then(i.bind(i,7685))},7685:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return b}});var n=i(1514),a=i(7993),s=i(8378),r=i(6736);let l="residency.ingestion.drafts.v1",o=[{title:"Demographics",description:"Study basics, patient demographics, addictions"},{title:"Clinical Profile",description:"Symptoms, comorbidities, etiology, AP severity"},{title:"Investigations",description:"Labs, imaging, SVT mapping, vascular findings"},{title:"Management",description:"Treatment, interventions, anticoagulation, outcomes"},{title:"Follow-up & Review",description:"Follow-up status, attachments, final QA"}],c=[{label:"Vomiting",key:"clinical_details__vomiting",durationKey:"clinical_details__vomiting_duration"},{label:"Fever",key:"clinical_details__fever",durationKey:"clinical_details__fever_duration"},{label:"Abdominal Distension",key:"clinical_details__abdominal_distension",durationKey:"clinical_details__abdominal_distension_duration"},{label:"Jaundice",key:"clinical_details__jaundice",durationKey:"clinical_details__jaundice_duration"},{label:"Chest Pain",key:"clinical_details__chest_pain",durationKey:"clinical_details__chest_pain_duration"},{label:"Dyspnoea",key:"clinical_details__dyspnoea",durationKey:"clinical_details__dyspnoea_duration"},{label:"Hematemesis",key:"clinical_details__hematemesis",durationKey:"clinical_details__hematemesis_duration"},{label:"Melena / Haematochezia",key:"clinical_details__melena_haematochezia",durationKey:"clinical_details__melena_haematochezia_duration"},{label:"Ascites",key:"clinical_details__ascites",durationKey:"clinical_details__ascites_duration"},{label:"Splenomegaly",key:"clinical_details__splenomegaly",durationKey:"clinical_details__splenomegaly_duration"}],d=[{label:"DM",key:"comorbidities__dm",durationKey:"comorbidities__dm_duration"},{label:"HTN",key:"comorbidities__htn",durationKey:"comorbidities__htn_duration"},{label:"CAD",key:"comorbidities__cad",durationKey:"comorbidities__cad_duration"},{label:"Obesity",key:"comorbidities__obesity",durationKey:"comorbidities__obesity_duration"},{label:"COPD",key:"comorbidities__copd",durationKey:"comorbidities__copd_duration"},{label:"CLD",key:"comorbidities__cld",durationKey:"comorbidities__cld_duration"},{label:"Thyroid Disorder",key:"comorbidities__thyroid_disorder",durationKey:"comorbidities__thyroid_disorder_duration"},{label:"Known Coagulopathy",key:"comorbidities__known_coagulopathy_disorder",durationKey:"comorbidities__known_coagulopathy_disorder_duration"}],u=[{value:"",label:"--"},{value:"yes",label:"Yes"},{value:"no",label:"No"}],_={template_id:"patient-proforma-v3",patient_id:"",encounter_date:"",diagnosis:"",visit_type:"baseline",svt_status:"without_svt",vessel_involvement:"",ward:"Gastro Surgery Ward",cohort_status:"active",mortality:"no",death_date:"",cause_of_death:"",recanalization_status:"not_applicable",primary_endpoint_complete:!1,notes:"",extra_fields:{}};function h(){return"row_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,8))}function p(){return{id:h(),date:"",parameter:"",value:""}}function m(){return{id:h(),date:"",modality:"",findings:""}}function v(){return{id:h(),date:"",intervention:"",indication:"",remarks:""}}function g(e){return e.replaceAll("__"," - ").replaceAll("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"string"==typeof e?e:"number"==typeof e||"boolean"==typeof e?String(e):t}function f(e){if(!e)return[];try{let t=JSON.parse(e);if(Array.isArray(t))return t}catch(e){}return[]}function j(e){return e.patient_id.trim().toUpperCase()||"WORKING-DRAFT"}function y(e){window.localStorage.setItem(l,JSON.stringify(e))}function b(){let[e,t]=(0,a.useState)("wizard"),[i,b]=(0,a.useState)(_),[w,N]=(0,a.useState)(0),[C,S]=(0,a.useState)("Idle"),[k,D]=(0,a.useState)(!1),[I,T]=(0,a.useState)([]),[A,P]=(0,a.useState)("Idle"),[z,E]=(0,a.useState)(null),[R,O]=(0,a.useState)("Idle"),[V,q]=(0,a.useState)(null),[L,F]=(0,a.useState)([]),[K,M]=(0,a.useState)([p()]),[U,B]=(0,a.useState)([m()]),[W,H]=(0,a.useState)([v()]),[J,G]=(0,a.useState)([]),[X,Q]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)(""),[$,ee]=(0,a.useState)([]),[et,ei]=(0,a.useState)(!1),[en,ea]=(0,a.useState)(null),[es,er]=(0,a.useState)("");(0,a.useEffect)(()=>{(0,s.pK)().then(e=>{T(e),!e.find(e=>e.template_id===i.template_id)&&e.length>0&&b(t=>({...t,template_id:e[0].template_id}))}).catch(e=>S("Template load failed: ".concat(e.message)))},[i.template_id]),(0,a.useEffect)(()=>{G(function(){try{let e=window.localStorage.getItem(l);if(!e)return[];let t=JSON.parse(e);if(!Array.isArray(t))return[];return t.filter(e=>!!(e&&"object"==typeof e))}catch(e){return[]}}()),Q(!0)},[]),(0,a.useEffect)(()=>{ei(!0),(0,s.on)(void 0,150).then(e=>{ee(e),er("")}).catch(e=>er(e.message||"Failed to load cases")).finally(()=>ei(!1))},[]),(0,a.useEffect)(()=>{if(!X)return;let e=setTimeout(()=>{let e=j(i),t={id:e,label:e,saved_at:new Date().toISOString(),step_index:w,wizard:i,lab_rows:K,imaging_rows:U,intervention_rows:W};G(i=>{let n=[t,...i.filter(t=>t.id!==e)].sort((e,t)=>t.saved_at.localeCompare(e.saved_at)).slice(0,12);return y(n),n})},500);return()=>window.clearTimeout(e)},[X,i,w,K,U,W]);let el=(0,a.useMemo)(()=>(function(e,t,i,n){var a,s,r,l,o,c,d,u,_,h,p,m;let v=[];return 0!==e||(t.patient_id.trim()||v.push("Study ID is required."),t.encounter_date.trim()||v.push("Assessment date is required."),t.diagnosis.trim()||v.push("Diagnosis is required."),t.ward.trim()||v.push("Ward is required."),(null===(a=t.extra_fields.demographics__age_sex)||void 0===a?void 0:a.trim())||v.push("Demographics: Age / Sex is required."),(null===(s=t.extra_fields.demographics__opd_ipd)||void 0===s?void 0:s.trim())||v.push("Demographics: OPD/IPD is required."),(null===(r=t.extra_fields.demographics__date_of_admission)||void 0===r?void 0:r.trim())||v.push("Demographics: Date of admission is required.")),1!==e||((null===(l=t.extra_fields.etiology_of_acute_pancreatitis__etiology)||void 0===l?void 0:l.trim())||v.push("Etiology of acute pancreatitis is required."),(null===(o=t.extra_fields.acute_pancreatitis__revised_atlanta_severity_grade)||void 0===o?void 0:o.trim())||v.push("Revised Atlanta severity grade is required.")),2!==e||(i.some(e=>e.date||e.parameter||e.value)||v.push("At least one laboratory investigation entry is required."),n.some(e=>e.date||e.modality||e.findings)||v.push("At least one imaging/endoscopy entry is required."),(null===(c=t.extra_fields.splanchnic_venous_assessment__portal_vein_pv)||void 0===c?void 0:c.trim())||v.push("SVT mapping: Portal vein status is required."),(null===(d=t.extra_fields.splanchnic_venous_assessment__smv)||void 0===d?void 0:d.trim())||v.push("SVT mapping: SMV status is required."),(null===(u=t.extra_fields.splanchnic_venous_assessment__splenic_vein_sv)||void 0===u?void 0:u.trim())||v.push("SVT mapping: Splenic vein status is required.")),3!==e||((null===(_=t.extra_fields.management__intervention)||void 0===_?void 0:_.trim())||v.push("Management: intervention status is required."),(null===(h=t.extra_fields.outcomes__total_hospital_stay)||void 0===h?void 0:h.trim())||v.push("Outcomes: total hospital stay is required."),"yes"!==t.mortality||(t.death_date.trim()||v.push("Death date is required when mortality is yes."),t.cause_of_death.trim()||v.push("Cause of death is required when mortality is yes."))),4!==e||((null===(p=t.extra_fields.follow_up__last_follow_up_date)||void 0===p?void 0:p.trim())||v.push("Follow-up: last follow-up date is required."),(null===(m=t.recanalization_status)||void 0===m?void 0:m.trim())||v.push("Recanalization status is required.")),"with_svt"!==t.svt_status||t.vessel_involvement.trim()||v.push("Vessel involvement is required for SVT cases."),v})(w,i,K,U),[w,i,K,U]);function eo(e,t){b(i=>({...i,[e]:t}))}function ec(e,t){b(i=>({...i,extra_fields:{...i.extra_fields,[e]:t}}))}function ed(e){return i.extra_fields[e]||""}function eu(e,t){M(i=>i.map(i=>i.id===e?{...i,...t}:i))}function e_(e,t){B(i=>i.map(i=>i.id===e?{...i,...t}:i))}function eh(e,t){H(i=>i.map(i=>i.id===e?{...i,...t}:i))}function ep(e){G(t=>{let i=t.filter(t=>t.id!==e);return y(i),i})}async function em(e){ei(!0),er("");try{let t=await (0,s.on)(e,150);ee(t)}catch(e){er(e instanceof Error?e.message:"Failed to load cases")}finally{ei(!1)}}async function ev(e){er("");try{let t=await (0,s.Ov)(e);ea(t)}catch(e){er(e instanceof Error?e.message:"Failed to load case details")}}async function eg(){P("Importing vault proformas..."),E(null);try{let e=await (0,s.Dp)();E(e),P("Import complete. Scanned ".concat(e.scanned_files,", imported ").concat(e.imported_files,", skipped ").concat(e.skipped_files,".")),await em(Y)}catch(t){let e=t instanceof Error?t.message:"Unknown error";P("Import failed: ".concat(e))}}async function ex(e){e.preventDefault(),O("Processing CSV..."),q(null);let t=new FormData(e.currentTarget).get("patient_csv");if(!(t instanceof File)||0===t.size){O("Select a CSV file before submitting.");return}try{let i=await (0,s.os)(t);q(i),O("CSV processed. Accepted ".concat(i.accepted_rows,"/").concat(i.total_rows,", rejected ").concat(i.rejected_rows,".")),e.currentTarget.reset(),await em(Y)}catch(t){let e=t instanceof Error?t.message:"Unknown error";O("CSV ingestion failed: ".concat(e))}}async function ef(){if(el.length>0){S("Cannot submit yet: ".concat(el[0]));return}D(!0),S("Submitting patient record...");try{let e=[];L.length>0&&(S("Uploading attachments..."),e=(await (0,s.c2)(L,i.patient_id||void 0)).files.map(e=>e.stored_path));let t=i.vessel_involvement.split(/[;,]/).map(e=>e.trim().toLowerCase()).filter(e=>e.length>0),n={template_id:i.template_id,patient_id:i.patient_id.trim(),encounter_date:i.encounter_date,diagnosis:i.diagnosis.trim(),visit_type:i.visit_type,svt_status:i.svt_status,vessel_involvement:t,ward:i.ward.trim(),cohort_status:i.cohort_status,mortality:i.mortality,death_date:i.death_date||void 0,cause_of_death:i.cause_of_death||void 0,recanalization_status:i.recanalization_status,primary_endpoint_complete:i.primary_endpoint_complete,notes:i.notes,extra_fields:function(e,t,i,n){let a={...e.extra_fields},s=t.filter(e=>e.date||e.parameter||e.value),r=i.filter(e=>e.date||e.modality||e.findings),l=n.filter(e=>e.date||e.intervention||e.indication||e.remarks);return s.length>0&&(a.investigations__laboratory_entries_json=JSON.stringify(s)),r.length>0&&(a.investigations__imaging_entries_json=JSON.stringify(r)),l.length>0&&(a.management__other_interventions_json=JSON.stringify(l)),a}(i,K,U,W),source_files:e},a=await (0,s.sD)(n);S("Submission stored. Note created at: ".concat(a.data.note_path));let r=j(i);ep(r),await em(Y)}catch(t){let e=t instanceof Error?t.message:"Unknown error";S("Submission failed: ".concat(e))}finally{D(!1)}}function ej(e,t,i){return(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:e}),(0,n.jsxs)("div",{style:{display:"grid",gap:8,gridTemplateColumns:i?"120px 1fr":"120px"},children:[(0,n.jsx)("select",{value:ed(t),onChange:e=>ec(t,e.target.value),children:u.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},"".concat(t,"-").concat(e.value)))}),i?(0,n.jsx)("input",{placeholder:"Duration / Details",value:ed(i),onChange:e=>ec(i,e.target.value)}):null]})]},t)}return(0,n.jsxs)("section",{className:"page",children:[(0,n.jsx)(r.m,{title:"Data Ingestion",description:"Protocol-driven, intuitive multi-step workflow for thesis case logging with autosave drafts, case reopening, and attachments."}),(0,n.jsxs)("div",{className:"ingestion-tabs",children:[(0,n.jsx)("button",{className:"wizard"===e?"ingestion-tab ingestion-tab--active":"ingestion-tab",onClick:()=>t("wizard"),children:"Patient Logging Wizard"}),(0,n.jsx)("button",{className:"cases"===e?"ingestion-tab ingestion-tab--active":"ingestion-tab",onClick:()=>t("cases"),children:"Case Browser"}),(0,n.jsx)("button",{className:"import"===e?"ingestion-tab ingestion-tab--active":"ingestion-tab",onClick:()=>t("import"),children:"Import Existing Proformas"}),(0,n.jsx)("button",{className:"csv"===e?"ingestion-tab ingestion-tab--active":"ingestion-tab",onClick:()=>t("csv"),children:"CSV Batch Ingestion"})]}),"wizard"===e?(0,n.jsxs)("div",{className:"wizard-shell",children:[(0,n.jsxs)("div",{className:"draft-strip",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Autosave Drafts"}),(0,n.jsx)("p",{className:"text-muted",children:"Draft is auto-saved while you type. Load any unfinished case below."})]}),(0,n.jsx)("button",{type:"button",onClick:function(){b(_),M([p()]),B([m()]),H([v()]),F([]),N(0),S("New form started.")},children:"Start New Form"})]}),J.length>0?(0,n.jsx)("div",{className:"draft-list",children:J.map(e=>(0,n.jsxs)("div",{className:"draft-chip",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:e.label}),(0,n.jsxs)("small",{children:["Saved ",new Date(e.saved_at).toLocaleString()]})]}),(0,n.jsxs)("div",{className:"draft-chip__actions",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{b(e.wizard),N(Math.min(Math.max(e.step_index,0),o.length-1)),M(e.lab_rows.length>0?e.lab_rows:[p()]),B(e.imaging_rows.length>0?e.imaging_rows:[m()]),H(e.intervention_rows.length>0?e.intervention_rows:[v()]),F([]),t("wizard"),S("Loaded draft ".concat(e.label,"."))},children:"Resume"}),(0,n.jsx)("button",{type:"button",onClick:()=>ep(e.id),children:"Delete"})]})]},e.id))}):null,(0,n.jsx)("ol",{className:"wizard-steps","aria-label":"Ingestion wizard steps",children:o.map((e,t)=>{let i=t===w?"wizard-step wizard-step--active":t<w?"wizard-step wizard-step--done":"wizard-step";return(0,n.jsx)("li",{className:i,children:(0,n.jsxs)("button",{type:"button",onClick:()=>N(t),children:[(0,n.jsx)("span",{className:"wizard-step__index",children:t+1}),(0,n.jsxs)("span",{children:[(0,n.jsx)("strong",{children:e.title}),(0,n.jsx)("small",{children:e.description})]})]})},e.title)})}),(0,n.jsx)("div",{className:"wizard-panel",children:0===w?(0,n.jsxs)("div",{className:"wizard-content",children:[(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Study Basics"}),(0,n.jsxs)("div",{className:"form-grid form-grid--two",children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Template"}),(0,n.jsx)("select",{value:i.template_id,onChange:e=>eo("template_id",e.target.value),children:I.map(e=>(0,n.jsxs)("option",{value:e.template_id,children:[e.title," (v",e.version,")"]},e.template_id))})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Study ID *"}),(0,n.jsx)("input",{value:i.patient_id,onChange:e=>eo("patient_id",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Assessment Date *"}),(0,n.jsx)("input",{type:"date",value:i.encounter_date,onChange:e=>eo("encounter_date",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Visit Type *"}),(0,n.jsxs)("select",{value:i.visit_type,onChange:e=>eo("visit_type",e.target.value),children:[(0,n.jsx)("option",{value:"baseline",children:"Baseline"}),(0,n.jsx)("option",{value:"day7_reassessment",children:"Day 7 Reassessment"}),(0,n.jsx)("option",{value:"discharge",children:"Discharge"}),(0,n.jsx)("option",{value:"week2_followup",children:"Week 2 Follow-up"}),(0,n.jsx)("option",{value:"month1_followup",children:"Month 1 Follow-up"}),(0,n.jsx)("option",{value:"month3_followup",children:"Month 3 Follow-up"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Diagnosis *"}),(0,n.jsx)("input",{value:i.diagnosis,onChange:e=>eo("diagnosis",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Ward *"}),(0,n.jsx)("input",{value:i.ward,onChange:e=>eo("ward",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Cohort Status"}),(0,n.jsxs)("select",{value:i.cohort_status,onChange:e=>eo("cohort_status",e.target.value),children:[(0,n.jsx)("option",{value:"screened",children:"Screened"}),(0,n.jsx)("option",{value:"enrolled",children:"Enrolled"}),(0,n.jsx)("option",{value:"active",children:"Active"}),(0,n.jsx)("option",{value:"completed",children:"Completed"}),(0,n.jsx)("option",{value:"terminal_outcome",children:"Terminal Outcome"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"SVT Status *"}),(0,n.jsxs)("select",{value:i.svt_status,onChange:e=>eo("svt_status",e.target.value),children:[(0,n.jsx)("option",{value:"without_svt",children:"Without SVT"}),(0,n.jsx)("option",{value:"with_svt",children:"With SVT"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Vessel Involvement (comma separated)"}),(0,n.jsx)("input",{placeholder:"pv, smv, sv, multiple, unknown",value:i.vessel_involvement,onChange:e=>eo("vessel_involvement",e.target.value)})]})]})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Demographics"}),(0,n.jsx)("div",{className:"form-grid form-grid--two",children:[["demographics__age_sex","Age / Sex *"],["demographics__cr_no","CR Number"],["demographics__contact_no","Contact Number"],["demographics__address","Address"],["demographics__opd_ipd","OPD/IPD *"],["demographics__date_of_admission","Date of Admission *"],["demographics__date_of_discharge","Date of Discharge"],["demographics__weight_height","Weight / Height"],["demographics__bmi","BMI"],["demographics__asa_classification","ASA Classification"]].map(e=>{let[t,i]=e;return(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:i}),(0,n.jsx)("input",{value:ed(t),onChange:e=>ec(t,e.target.value)})]},t)})})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Addictions"}),(0,n.jsx)("div",{className:"form-grid form-grid--two",children:[["addictions__alcohol","Alcohol"],["addictions__smoking","Smoking"],["addictions__tobacco_chewing","Tobacco Chewing"],["addictions__others","Others"]].map(e=>{let[t,i]=e;return(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:i}),(0,n.jsx)("input",{value:ed(t),onChange:e=>ec(t,e.target.value)})]},t)})})]})]}):1===w?(0,n.jsxs)("div",{className:"wizard-content",children:[(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Pain and Clinical Details"}),(0,n.jsx)("div",{className:"form-grid form-grid--two",children:[["clinical_details__index_pain","Index Pain Date"],["clinical_details__current_pain","Current Pain Duration"],["clinical_details__pain_duration","Pain Duration Detail"],["clinical_details__pain_site","Pain Site"],["clinical_details__severity_vas_1_10","VAS Score (1-10)"]].map(e=>{let[t,i]=e;return(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:i}),(0,n.jsx)("input",{value:ed(t),onChange:e=>ec(t,e.target.value)})]},t)})}),(0,n.jsx)("div",{className:"form-grid form-grid--two",style:{marginTop:12},children:c.map(e=>ej(e.label,e.key,e.durationKey))})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Comorbidities"}),(0,n.jsxs)("div",{className:"form-grid form-grid--two",children:[d.map(e=>ej(e.label,e.key,e.durationKey)),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Other Comorbidities"}),(0,n.jsx)("input",{value:ed("comorbidities__other"),onChange:e=>ec("comorbidities__other",e.target.value)})]})]})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Etiology and AP Severity"}),(0,n.jsxs)("div",{className:"form-grid form-grid--two",children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Etiology of Acute Pancreatitis *"}),(0,n.jsx)("input",{placeholder:"Alcohol / Biliary / Hypertriglyceridemia / Hypercalcemia / Post ERCP / Idiopathic / Other",value:ed("etiology_of_acute_pancreatitis__etiology"),onChange:e=>ec("etiology_of_acute_pancreatitis__etiology",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Revised Atlanta Severity Grade *"}),(0,n.jsxs)("select",{value:ed("acute_pancreatitis__revised_atlanta_severity_grade"),onChange:e=>ec("acute_pancreatitis__revised_atlanta_severity_grade",e.target.value),children:[(0,n.jsx)("option",{value:"",children:"--"}),(0,n.jsx)("option",{value:"mild",children:"Mild"}),(0,n.jsx)("option",{value:"moderately_severe",children:"Moderately Severe"}),(0,n.jsx)("option",{value:"severe",children:"Severe"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Modified CTSI"}),(0,n.jsx)("input",{value:ed("acute_pancreatitis__modified_ct_severity_score"),onChange:e=>ec("acute_pancreatitis__modified_ct_severity_score",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Acute Pancreatitis Type"}),(0,n.jsxs)("select",{value:ed("acute_pancreatitis__type"),onChange:e=>ec("acute_pancreatitis__type",e.target.value),children:[(0,n.jsx)("option",{value:"",children:"--"}),(0,n.jsx)("option",{value:"edematous_interstitial",children:"Edematous (Interstitial)"}),(0,n.jsx)("option",{value:"necrotizing",children:"Necrotizing"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Pancreatic Necrosis"}),(0,n.jsx)("input",{placeholder:"yes/no + sterile/infected",value:ed("acute_pancreatitis__pancreatic_necrosis"),onChange:e=>ec("acute_pancreatitis__pancreatic_necrosis",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"GIT Complications"}),(0,n.jsx)("input",{placeholder:"Perforation / Obstruction / Fistula / Ischemia / Bleeding / Other",value:ed("acute_pancreatitis__git_complications"),onChange:e=>ec("acute_pancreatitis__git_complications",e.target.value)})]})]})]})]}):2===w?(0,n.jsxs)("div",{className:"wizard-content",children:[(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Laboratory Investigations"}),(0,n.jsx)("p",{className:"text-muted",children:"Capture each point as Date + Parameter + Value."}),(0,n.jsx)("div",{className:"table-editor",children:K.map(e=>(0,n.jsxs)("div",{className:"table-editor__row",children:[(0,n.jsx)("input",{type:"date",value:e.date,onChange:t=>eu(e.id,{date:t.target.value})}),(0,n.jsx)("input",{placeholder:"Parameter",value:e.parameter,onChange:t=>eu(e.id,{parameter:t.target.value})}),(0,n.jsx)("input",{placeholder:"Value",value:e.value,onChange:t=>eu(e.id,{value:t.target.value})}),(0,n.jsx)("button",{type:"button",onClick:()=>M(t=>t.filter(t=>t.id!==e.id)),children:"Remove"})]},e.id))}),(0,n.jsx)("button",{type:"button",onClick:()=>M(e=>[...e,p()]),children:"+ Add Lab Entry"})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Imaging / Endoscopy"}),(0,n.jsx)("div",{className:"table-editor",children:U.map(e=>(0,n.jsxs)("div",{className:"table-editor__row",children:[(0,n.jsx)("input",{type:"date",value:e.date,onChange:t=>e_(e.id,{date:t.target.value})}),(0,n.jsx)("input",{placeholder:"Modality",value:e.modality,onChange:t=>e_(e.id,{modality:t.target.value})}),(0,n.jsx)("input",{placeholder:"Key findings",value:e.findings,onChange:t=>e_(e.id,{findings:t.target.value})}),(0,n.jsx)("button",{type:"button",onClick:()=>B(t=>t.filter(t=>t.id!==e.id)),children:"Remove"})]},e.id))}),(0,n.jsx)("button",{type:"button",onClick:()=>B(e=>[...e,m()]),children:"+ Add Imaging Entry"})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"SVT and Vascular Mapping"}),(0,n.jsx)("div",{className:"form-grid form-grid--two",children:["overall_findings__pancreas","overall_findings__necrosis_location","overall_findings__necrosis_percent","overall_findings__necrosis_site","overall_findings__peripancreatic_fluid_collection","overall_findings__pancreatic_fluid_collection","overall_findings__pseudocyst_won","overall_findings__modified_ctsi","splanchnic_venous_assessment__thrombosis_locations","splanchnic_venous_assessment__time_first_detection_days","splanchnic_venous_assessment__portal_vein_pv","splanchnic_venous_assessment__smv","splanchnic_venous_assessment__splenic_vein_sv","splanchnic_venous_assessment__smv_sv_confluence","portal_hypertensive_changes__splenomegaly","portal_hypertensive_changes__ascites","portal_hypertensive_changes__varices","portal_hypertensive_changes__collaterals","portal_hypertensive_changes__portal_gastropathy","vascular_complications__arterial_pseudoaneurysm","vascular_complications__intra_abdominal_bleeding","vascular_complications__bowel_ischemia","vascular_complications__splenic_infarction"].map(e=>(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:g(e)}),(0,n.jsx)("input",{value:ed(e),onChange:t=>ec(e,t.target.value)})]},e))})]})]}):3===w?(0,n.jsxs)("div",{className:"wizard-content",children:[(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Management"}),(0,n.jsxs)("div",{className:"form-grid form-grid--two",children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Conservative Management Components"}),(0,n.jsx)("input",{placeholder:"ICU / PN / ionotropes / ventilator / HD / CRRT / other",value:ed("management__conservative"),onChange:e=>ec("management__conservative",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Intervention Performed *"}),(0,n.jsx)("input",{value:ed("management__intervention"),onChange:e=>ec("management__intervention",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"First Intervention"}),(0,n.jsx)("input",{value:ed("management__first_intervention"),onChange:e=>ec("management__first_intervention",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"First Intervention Date"}),(0,n.jsx)("input",{value:ed("management__first_intervention_date"),onChange:e=>ec("management__first_intervention_date",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Time to First Intervention (days)"}),(0,n.jsx)("input",{value:ed("management__time_to_first_intervention_days"),onChange:e=>ec("management__time_to_first_intervention_days",e.target.value)})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Anticoagulation Therapy"}),(0,n.jsx)("input",{placeholder:"yes/no + indication + initial + maintenance + duration",value:ed("management__anticoagulation_therapy"),onChange:e=>ec("management__anticoagulation_therapy",e.target.value)})]})]})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Other Interventions"}),(0,n.jsx)("div",{className:"table-editor",children:W.map(e=>(0,n.jsxs)("div",{className:"table-editor__row table-editor__row--five",children:[(0,n.jsx)("input",{type:"date",value:e.date,onChange:t=>eh(e.id,{date:t.target.value})}),(0,n.jsx)("input",{placeholder:"Intervention",value:e.intervention,onChange:t=>eh(e.id,{intervention:t.target.value})}),(0,n.jsx)("input",{placeholder:"Indication",value:e.indication,onChange:t=>eh(e.id,{indication:t.target.value})}),(0,n.jsx)("input",{placeholder:"Remarks",value:e.remarks,onChange:t=>eh(e.id,{remarks:t.target.value})}),(0,n.jsx)("button",{type:"button",onClick:()=>H(t=>t.filter(t=>t.id!==e.id)),children:"Remove"})]},e.id))}),(0,n.jsx)("button",{type:"button",onClick:()=>H(e=>[...e,v()]),children:"+ Add Intervention"})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Outcomes"}),(0,n.jsx)("div",{className:"form-grid form-grid--two",children:["outcomes__icu_stay","outcomes__total_hospital_stay","outcomes__organ_failure","outcomes__bowel_ischemia","outcomes__bleeding","outcomes__variceal_bleeding","outcomes__splenic_infarction","outcomes__bleeding_on_anticoagulation","outcomes__readmission","outcomes__mortality_in_hospital","outcomes__mortality_after_discharge","outcomes__mortality_cause"].map(e=>(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:g(e)}),(0,n.jsx)("input",{value:ed(e),onChange:t=>ec(e,t.target.value)})]},e))}),(0,n.jsxs)("div",{className:"form-grid form-grid--two",style:{marginTop:10},children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Mortality"}),(0,n.jsxs)("select",{value:i.mortality,onChange:e=>eo("mortality",e.target.value),children:[(0,n.jsx)("option",{value:"no",children:"No"}),(0,n.jsx)("option",{value:"yes",children:"Yes"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Date of Death"}),(0,n.jsx)("input",{type:"date",value:i.death_date,onChange:e=>eo("death_date",e.target.value),disabled:"yes"!==i.mortality})]}),(0,n.jsxs)("div",{className:"input-group",style:{gridColumn:"1 / -1"},children:[(0,n.jsx)("label",{children:"Cause of Death"}),(0,n.jsx)("input",{value:i.cause_of_death,onChange:e=>eo("cause_of_death",e.target.value),disabled:"yes"!==i.mortality})]})]})]})]}):(0,n.jsxs)("div",{className:"wizard-content",children:[(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Follow-up"}),(0,n.jsxs)("div",{className:"form-grid form-grid--two",children:[["follow_up__svt_assessment_date","follow_up__svt_assessment_interval","follow_up__progression_partial_to_total","follow_up__progression_new_veins","follow_up__progression_segmental_extension","follow_up__recanalization","follow_up__new_onset_thrombosis","follow_up__persistence_of_svt","follow_up__last_follow_up_date","follow_up__duration_since_discharge"].map(e=>(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:g(e)}),(0,n.jsx)("input",{value:ed(e),onChange:t=>ec(e,t.target.value)})]},e)),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Recanalization Status"}),(0,n.jsxs)("select",{value:i.recanalization_status,onChange:e=>eo("recanalization_status",e.target.value),children:[(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"complete",children:"Complete"}),(0,n.jsx)("option",{value:"partial",children:"Partial"}),(0,n.jsx)("option",{value:"none",children:"None"}),(0,n.jsx)("option",{value:"progressed",children:"Progressed"}),(0,n.jsx)("option",{value:"not_applicable",children:"Not Applicable"})]})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{children:"Primary Endpoint Complete"}),(0,n.jsxs)("label",{className:"checkbox-row",children:[(0,n.jsx)("input",{type:"checkbox",checked:i.primary_endpoint_complete,onChange:e=>eo("primary_endpoint_complete",e.target.checked)}),"Mark complete (typically month 3 follow-up)"]})]})]})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Attachments"}),(0,n.jsx)("p",{className:"text-muted",children:"Attach imaging/report files for this patient submission."}),(0,n.jsx)("input",{type:"file",multiple:!0,onChange:e=>F(Array.from(e.target.files||[]))}),L.length>0?(0,n.jsx)("ul",{children:L.map(e=>(0,n.jsx)("li",{children:e.name},"".concat(e.name,"-").concat(e.size)))}):(0,n.jsx)("p",{className:"text-muted",children:"No files selected."})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Clinical Notes"}),(0,n.jsx)("textarea",{rows:5,value:i.notes,onChange:e=>eo("notes",e.target.value),placeholder:"Any other relevant morbidity / complication / treatment notes"})]}),(0,n.jsxs)("div",{className:"form-card",children:[(0,n.jsx)("h3",{children:"Review"}),(0,n.jsxs)("div",{className:"review-grid",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Study ID"}),(0,n.jsx)("p",{children:i.patient_id||"-"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Assessment Date"}),(0,n.jsx)("p",{children:i.encounter_date||"-"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Visit Type"}),(0,n.jsx)("p",{children:i.visit_type})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"SVT Status"}),(0,n.jsx)("p",{children:i.svt_status})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Lab Entries"}),(0,n.jsx)("p",{children:K.filter(e=>e.date||e.parameter||e.value).length})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Imaging Entries"}),(0,n.jsx)("p",{children:U.filter(e=>e.date||e.modality||e.findings).length})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Attachments"}),(0,n.jsx)("p",{children:L.length})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Protocol Fields Captured"}),(0,n.jsx)("p",{children:Object.keys(i.extra_fields).length})]})]})]})]})}),el.length>0?(0,n.jsxs)("div",{className:"wizard-error-list",children:[(0,n.jsx)("strong",{children:"Complete required fields before moving ahead:"}),(0,n.jsx)("ul",{children:el.map(e=>(0,n.jsx)("li",{children:e},e))})]}):null,(0,n.jsx)("p",{children:C}),(0,n.jsxs)("div",{className:"wizard-actions",children:[(0,n.jsx)("button",{type:"button",onClick:function(){N(e=>Math.max(e-1,0))},disabled:0===w||k,children:"Previous"}),w<o.length-1?(0,n.jsx)("button",{type:"button",onClick:function(){if(el.length>0){S("Fix this step first: ".concat(el[0]));return}N(e=>Math.min(e+1,o.length-1))},disabled:k||el.length>0,children:"Next Step"}):(0,n.jsx)("button",{type:"button",onClick:ef,disabled:k||el.length>0,children:k?"Submitting...":"Submit Patient Case"})]})]}):null,"cases"===e?(0,n.jsxs)("div",{className:"panel",children:[(0,n.jsxs)("div",{className:"panel__header",children:[(0,n.jsx)("h2",{children:"Case Browser and Re-open"}),(0,n.jsx)("p",{children:"Search existing imported/submitted cases and load them back into the wizard for editing."})]}),(0,n.jsxs)("div",{className:"panel__body panel__body--compact",children:[(0,n.jsxs)("div",{className:"case-search-row",children:[(0,n.jsx)("input",{placeholder:"Search by Study ID, diagnosis, ward",value:Y,onChange:e=>Z(e.target.value)}),(0,n.jsx)("button",{type:"button",onClick:()=>em(Y),children:"Search"}),(0,n.jsx)("button",{type:"button",onClick:()=>em(void 0),children:"Reset"})]}),et?(0,n.jsx)("p",{children:"Loading cases..."}):null,es?(0,n.jsx)("p",{className:"wizard-error",children:es}):null,(0,n.jsx)("div",{className:"table-wrap",style:{maxHeight:"50vh"},children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Study ID"}),(0,n.jsx)("th",{children:"Encounter"}),(0,n.jsx)("th",{children:"Visit"}),(0,n.jsx)("th",{children:"SVT"}),(0,n.jsx)("th",{children:"Diagnosis"}),(0,n.jsx)("th",{children:"Events"}),(0,n.jsx)("th",{})]})}),(0,n.jsx)("tbody",{children:$.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.patient_id}),(0,n.jsx)("td",{children:e.encounter_date||"-"}),(0,n.jsx)("td",{children:e.visit_type}),(0,n.jsx)("td",{children:e.svt_status}),(0,n.jsx)("td",{children:e.diagnosis||"-"}),(0,n.jsx)("td",{children:e.event_count}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{type:"button",onClick:()=>ev(e.patient_id),children:"Open"})})]},"".concat(e.patient_id,"-").concat(e.event_id)))})]})}),en?(0,n.jsxs)("div",{className:"case-detail-card",children:[(0,n.jsx)("h3",{children:en.summary.patient_id}),(0,n.jsxs)("p",{className:"text-muted",children:["Latest visit: ",en.summary.visit_type," | Encounter: ",en.summary.encounter_date||"-"]}),(0,n.jsxs)("div",{className:"review-grid",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Diagnosis"}),(0,n.jsx)("p",{children:en.summary.diagnosis||"-"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Ward"}),(0,n.jsx)("p",{children:en.summary.ward||"-"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Cohort"}),(0,n.jsx)("p",{children:en.summary.cohort_status})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"History Rows"}),(0,n.jsx)("p",{children:en.history.length})]})]}),(0,n.jsx)("button",{type:"button",onClick:()=>(function(e){let i=e.payload||{},{extra:n,labRows:a,imagingRows:s,interventionRows:r}=function(e){let t=e.extra_fields,i={};if(t&&"object"==typeof t)for(let[e,n]of Object.entries(t)){let t=e.trim();if(!t)continue;let a=x(n).trim();a&&(i[t]=a)}let n=f(i.investigations__laboratory_entries_json),a=f(i.investigations__imaging_entries_json),s=f(i.management__other_interventions_json);return delete i.investigations__laboratory_entries_json,delete i.investigations__imaging_entries_json,delete i.management__other_interventions_json,{extra:i,labRows:n.length>0?n.map(e=>({...e,id:e.id||h()})):[p()],imagingRows:a.length>0?a.map(e=>({...e,id:e.id||h()})):[m()],interventionRows:s.length>0?s.map(e=>({...e,id:e.id||h()})):[v()]}}(i),l=i.vessel_involvement,o=Array.isArray(l)?l.map(e=>x(e).trim()).filter(Boolean).join(", "):x(l);b({template_id:x(i.template_id,"patient-proforma-v3")||"patient-proforma-v3",patient_id:x(i.patient_id),encounter_date:x(i.encounter_date),diagnosis:x(i.diagnosis),visit_type:x(i.visit_type,"baseline")||"baseline",svt_status:x(i.svt_status,"without_svt")||"without_svt",vessel_involvement:o,ward:x(i.ward,"Gastro Surgery Ward"),cohort_status:x(i.cohort_status,"active")||"active",mortality:x(i.mortality,"no")||"no",death_date:x(i.death_date),cause_of_death:x(i.cause_of_death),recanalization_status:x(i.recanalization_status,"not_applicable")||"not_applicable",primary_endpoint_complete:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("boolean"==typeof e)return e;if("string"==typeof e){let t=e.trim().toLowerCase();if(["true","1","yes","y"].includes(t))return!0;if(["false","0","no","n"].includes(t))return!1}return t}(i.primary_endpoint_complete,!1),notes:x(i.notes),extra_fields:n}),M(a),B(s),H(r),F([]),t("wizard"),N(0),S("Loaded case ".concat(e.summary.patient_id,". Submitting will create a new revision event."))})(en),children:"Load Into Wizard (Create New Revision)"})]}):null]})]}):null,"import"===e?(0,n.jsxs)("div",{className:"panel",children:[(0,n.jsxs)("div",{className:"panel__header",children:[(0,n.jsx)("h2",{children:"Backfill Existing Vault Proformas"}),(0,n.jsx)("p",{children:"Import all historical patient proforma markdown files into the analytics event stream."})]}),(0,n.jsxs)("div",{className:"panel__body panel__body--compact",children:[(0,n.jsx)("button",{type:"button",onClick:eg,style:{width:"fit-content",padding:"8px 14px"},children:"Import Existing Vault Proformas"}),(0,n.jsx)("p",{children:A}),z?(0,n.jsxs)("div",{className:"review-grid",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Scanned"}),(0,n.jsx)("p",{children:z.scanned_files})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Imported"}),(0,n.jsx)("p",{children:z.imported_files})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Skipped"}),(0,n.jsx)("p",{children:z.skipped_files})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Errors"}),(0,n.jsx)("p",{children:z.errors.length})]})]}):null,z&&z.errors.length>0?(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Import Issues"}),(0,n.jsx)("ul",{children:z.errors.slice(0,15).map(e=>(0,n.jsxs)("li",{children:[e.file_path,": ",e.message]},"".concat(e.file_path,"-").concat(e.message)))})]}):null]})]}):null,"csv"===e?(0,n.jsxs)("div",{className:"panel",children:[(0,n.jsxs)("div",{className:"panel__header",children:[(0,n.jsx)("h2",{children:"CSV Batch Ingestion"}),(0,n.jsx)("p",{children:"Use this for bulk updates. Additional columns are preserved automatically."})]}),(0,n.jsxs)("div",{className:"panel__body panel__body--compact",children:[(0,n.jsxs)("form",{onSubmit:ex,style:{display:"grid",gap:10,maxWidth:560},children:[(0,n.jsxs)("label",{children:["CSV File",(0,n.jsx)("input",{name:"patient_csv",type:"file",accept:".csv,text/csv",required:!0,style:{width:"100%"}})]}),(0,n.jsx)("button",{type:"submit",style:{width:"fit-content",padding:"8px 14px"},children:"Process CSV"})]}),(0,n.jsx)("p",{children:R}),V&&V.errors.length>0?(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"CSV Errors"}),(0,n.jsx)("ul",{children:V.errors.slice(0,12).map((e,t)=>(0,n.jsxs)("li",{children:["Row ",e.row_number,": ",e.message]},"".concat(e.row_number,"-").concat(t)))})]}):null]})]}):null]})}},6736:function(e,t,i){"use strict";i.d(t,{m:function(){return a}});var n=i(1514);function a(e){let{title:t,description:i,actions:a}=e;return(0,n.jsxs)("header",{className:"page-header",children:[(0,n.jsx)("h1",{className:"page-title",children:t}),(0,n.jsx)("p",{className:"page-subtitle",children:i}),a?(0,n.jsx)("div",{children:a}):null]})}},8378:function(e,t,i){"use strict";i.d(t,{B:function(){return j},Dp:function(){return _},G:function(){return b},Ov:function(){return p},Vt:function(){return g},WV:function(){return y},XT:function(){return f},Zj:function(){return o},c2:function(){return d},fP:function(){return m},iX:function(){return r},kK:function(){return v},on:function(){return h},os:function(){return u},pK:function(){return l},sD:function(){return c},xQ:function(){return x}});let n=i(3069).env.NEXT_PUBLIC_API_BASE_URL||"http://127.0.0.1:8000";async function a(e){let t=await fetch("".concat(n).concat(e),{cache:"no-store"});if(!t.ok)throw Error("Request failed: ".concat(t.status));return(await t.json()).data}async function s(e,t){let i=await fetch("".concat(n).concat(e),{method:"POST",body:t});if(!i.ok)throw Error(await i.text()||"Request failed: ".concat(i.status));return(await i.json()).data}function r(){return a("/vault/folders")}function l(){return a("/templates")}function o(e,t){let i=new EventSource("".concat(n,"/vault/stream"));return i.addEventListener("vault_tree",t=>{e(JSON.parse(t.data))}),t&&(i.onerror=()=>t()),i}async function c(e){let t=await fetch("".concat(n,"/ingestion/patient"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"Failed to submit patient data");return await t.json()}async function d(e,t){let i=new FormData;for(let t of e)i.append("files",t);return t&&i.append("patient_id",t),s("/ingestion/files",i)}async function u(e){let t=new FormData;return t.append("file",e),s("/ingestion/patient-csv",t)}async function _(){let e=await fetch("".concat(n,"/ingestion/import-proformas"),{method:"POST"});if(!e.ok)throw Error(await e.text()||"Failed to import proformas");return(await e.json()).data}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=new URLSearchParams;return i.set("limit",String(t)),e&&e.trim()&&i.set("q",e.trim()),a("/ingestion/cases?".concat(i.toString()))}function p(e){return a("/ingestion/cases/".concat(encodeURIComponent(e)))}function m(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200,s=new URLSearchParams;return s.set("limit",String(n)),e&&e.trim()&&s.set("q",e.trim()),t&&s.set("svt_status",t),i&&s.set("case_bucket",i),a("/patients?".concat(s.toString()))}function v(e){return a("/patients/".concat(encodeURIComponent(e)))}function g(e,t){return a("/patients/".concat(encodeURIComponent(e),"/files/").concat(encodeURIComponent(t),"/preview"))}function x(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12e4;return a("/patients/".concat(encodeURIComponent(e),"/files/").concat(encodeURIComponent(t),"/extracted?max_chars=").concat(i))}function f(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,n=new URLSearchParams;return n.set("q",e),n.set("limit",String(i)),t&&n.set("patient_key",t),a("/patients/search?".concat(n.toString()))}function j(){return a("/patients/index/status")}async function y(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams;a.set("force",String(e)),t&&a.set("patient_key",t),i&&a.set("file_id",i);let s=await fetch("".concat(n,"/patients/index/reindex?").concat(a.toString()),{method:"POST"});if(!s.ok)throw Error(await s.text()||"Request failed: ".concat(s.status));return(await s.json()).data}function b(e,t){return"".concat(n,"/patients/").concat(encodeURIComponent(e),"/files/").concat(encodeURIComponent(t))}},3069:function(e,t,i){"use strict";var n,a;e.exports=(null==(n=i.g.process)?void 0:n.env)&&"object"==typeof(null==(a=i.g.process)?void 0:a.env)?i.g.process:i(7030)},7030:function(e){!function(){var t={229:function(e){var t,i,n,a=e.exports={};function s(){throw Error("setTimeout has not been defined")}function r(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(e){i=r}}();var o=[],c=!1,d=-1;function u(){c&&n&&(c=!1,n.length?o=n.concat(o):d=-1,o.length&&_())}function _(){if(!c){var e=l(u);c=!0;for(var t=o.length;t;){for(n=o,o=[];++d<t;)n&&n[d].run();d=-1,t=o.length}n=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];o.push(new h(e,t)),1!==o.length||c||l(_)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},i={};function n(e){var a=i[e];if(void 0!==a)return a.exports;var s=i[e]={exports:{}},r=!0;try{t[e](s,s.exports,n),r=!1}finally{r&&delete i[e]}return s.exports}n.ab="//";var a=n(229);e.exports=a}()}},function(e){e.O(0,[869,753,744],function(){return e(e.s=3948)}),_N_E=e.O()}]);